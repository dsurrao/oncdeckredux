<form [formGroup]="biopsyForm" (ngSubmit)="onSubmit()">
    <div *ngIf="validationErrors && 
        (biopsyForm.dirty || biopsyForm.touched)" 
        class="validation-error">
        {{validationErrors}}
    </div>

    <mat-vertical-stepper>
        <mat-step label="Report">
            <mat-radio-group formControlName="status" required>
                <mat-radio-button value="{{procedureStatusEnum.Completed}}">
                    {{procedureStatusEnum.Completed}}
                </mat-radio-button>
                <mat-radio-button value="{{procedureStatusEnum.NotDone}}">
                    {{procedureStatusEnum.NotDone}}
                </mat-radio-button>
            </mat-radio-group>

            <mat-form-field>
                <input matInput type="text" formControlName="statusReason"
                    placeholder="Status Reason"/>
            </mat-form-field>

            <mat-form-field>
                <input matInput type="date" formControlName="pathologyReportDate"
                    placeholder="Pathology Report Date"/>
            </mat-form-field>
            
            <div>
                <button mat-button matStepperPrevious type="button">Back</button>
                <button mat-button matStepperNext type="button">Next</button>
            </div>
        </mat-step>

        <mat-step label="Biopsy Site">
            <div formGroupName="site">
                <mat-radio-group formControlName="site">
                    <mat-radio-button value="{{biopsySiteEnum.Breast}}">
                        {{biopsySiteEnum.Breast}}
                    </mat-radio-button>
                    <mat-radio-button value="{{biopsySiteEnum.LymphNode}}">
                        {{biopsySiteEnum.LymphNode}}
                    </mat-radio-button>
                    <mat-radio-button value="{{biopsySiteEnum.SkinNodule}}">
                        {{biopsySiteEnum.SkinNodule}}
                    </mat-radio-button>
                    <mat-radio-button value="{{biopsySiteEnum.Other}}">
                        {{biopsySiteEnum.Other}}
                    </mat-radio-button>
                </mat-radio-group>

                <div class="spacer"></div>

                <mat-form-field>
                    <input matInput type="text" placeholder="Site (Other)" 
                        formControlName="siteOther"/>
                </mat-form-field>

                <div class="spacer"></div>

                <mat-radio-group formControlName="side">
                    <mat-radio-button value="{{sideEnum.Right}}">
                        {{sideEnum.Right}}
                    </mat-radio-button>
                    <mat-radio-button value="{{sideEnum.Left}}">
                        {{sideEnum.Left}}
                    </mat-radio-button>
                </mat-radio-group>

                <div class="spacer"></div>
                <div class="spacer"></div>

                <mat-radio-group formControlName="lymphNodeLocation">
                    <mat-radio-button value="{{lymphNodeLocationEnum.Axillary}}">
                        {{lymphNodeLocationEnum.Axillary}}
                    </mat-radio-button>
                    <mat-radio-button value="{{lymphNodeLocationEnum.Supraclavicular}}">
                        {{lymphNodeLocationEnum.Supraclavicular}}
                    </mat-radio-button>
                    <mat-radio-button value="{{lymphNodeLocationEnum.Cervical}}" >
                        {{lymphNodeLocationEnum.Cervical}}
                    </mat-radio-button>
                    <mat-radio-button value="{{lymphNodeLocationEnum.Other}}">
                        {{lymphNodeLocationEnum.Other}}
                    </mat-radio-button>
                </mat-radio-group>
                <mat-form-field>
                    <input matInput type="text" placeholder="Lymph Node Location (Other)"
                        formControlName="lymphNodeLocationOther"/>
                </mat-form-field>

                <div class="spacer"></div>
                <div class="spacer"></div>

                <div>
                    <button mat-button matStepperPrevious type="button">Back</button>
                    <button mat-button matStepperNext type="button">Next</button>
                </div>
            </div>
        </mat-step>

        <mat-step label="Biopsy Histology">
            <div formGroupName="histology">
                <mat-radio-group formControlName="histology">
                    <mat-radio-button value="{{biopsyHistologyEnum.InvasiveDuctalCarcinoma}}" >
                        {{biopsyHistologyEnum.InvasiveDuctalCarcinoma}}
                    </mat-radio-button>
                    <mat-radio-button value="{{biopsyHistologyEnum.InvasiveLobularCarcinoma}}" >
                        {{biopsyHistologyEnum.InvasiveLobularCarcinoma}}
                    </mat-radio-button>
                    <mat-radio-button value="{{biopsyHistologyEnum.DuctalCarcinomaInSitu}}" >
                        {{biopsyHistologyEnum.DuctalCarcinomaInSitu}}
                    </mat-radio-button>
                    <mat-radio-button value="{{biopsyHistologyEnum.LobularCarcinomaInSitu}}" >
                        {{biopsyHistologyEnum.LobularCarcinomaInSitu}}
                    </mat-radio-button>
                    <mat-radio-button value="{{biopsyHistologyEnum.Other}}" >
                        {{biopsyHistologyEnum.Other}}
                    </mat-radio-button>
                </mat-radio-group>
                <mat-form-field>
                    <input matInput type="text" placeholder="Histology (Other)" 
                        formControlName="histologyOther"/>
                </mat-form-field>
                <div>
                    <button mat-button matStepperPrevious type="button">Back</button>
                    <button mat-button matStepperNext type="button">Next</button>
                </div>
            </div>
        </mat-step>

        <mat-step label="ER Receptor">
            <div formGroupName="receptors">
                <div formGroupName="erReceptor">
                    <mat-radio-group formControlName="status" aria-label="Estrogen Receptor">
                        <mat-radio-button value="{{biopsyReceptorStatusEnum.Positive}}" >
                            ER+
                        </mat-radio-button>
                        <mat-radio-button value="{{biopsyReceptorStatusEnum.Negative}}" >
                            ER-
                        </mat-radio-button>
                        <mat-radio-button value="{{biopsyReceptorStatusEnum.Unknown}}" >
                            {{biopsyReceptorStatusEnum.Unknown}}
                        </mat-radio-button>
                    </mat-radio-group>

                    <div class="spacer"></div>

                    <mat-radio-group formControlName="strength"  aria-label="ER strength">
                        <mat-radio-button value="{{biopsyReceptorStrengthEnum.Strong}}" >
                            {{biopsyReceptorStrengthEnum.Strong}}
                        </mat-radio-button>
                        <mat-radio-button value="{{biopsyReceptorStrengthEnum.Moderate}}" >
                            {{biopsyReceptorStrengthEnum.Moderate}}
                        </mat-radio-button>
                        <mat-radio-button value="{{biopsyReceptorStrengthEnum.Weak}}" >
                            {{biopsyReceptorStrengthEnum.Weak}}
                        </mat-radio-button>
                    </mat-radio-group>

                    <div>
                        <button mat-button matStepperPrevious type="button">Back</button>
                        <button mat-button matStepperNext type="button">Next</button>
                    </div>
                </div>
            </div>
        </mat-step>

        <mat-step label="PR Receptor">
            <div formGroupName="receptors">
                <div formGroupName="prReceptor">
                    <mat-radio-group formControlName="status" 
                        aria-label="Progesterone Receptor">
                        <mat-radio-button value="{{biopsyReceptorStatusEnum.Positive}}" >
                            PR+
                        </mat-radio-button>
                        <mat-radio-button value="{{biopsyReceptorStatusEnum.Negative}}" >
                            PR-
                        </mat-radio-button>
                        <mat-radio-button value="{{biopsyReceptorStatusEnum.Unknown}}" >
                            {{biopsyReceptorStatusEnum.Unknown}}
                        </mat-radio-button>
                    </mat-radio-group>

                    <div class="spacer"></div>

                    <mat-radio-group formControlName="strength" 
                        aria-label="PR strength">
                        <mat-radio-button value="{{biopsyReceptorStrengthEnum.Strong}}" >
                            {{biopsyReceptorStrengthEnum.Strong}}
                        </mat-radio-button>
                        <mat-radio-button value="{{biopsyReceptorStrengthEnum.Moderate}}" >
                            {{biopsyReceptorStrengthEnum.Moderate}}
                        </mat-radio-button>
                        <mat-radio-button value="{{biopsyReceptorStrengthEnum.Weak}}" >
                            {{biopsyReceptorStrengthEnum.Weak}}
                        </mat-radio-button>
                    </mat-radio-group>

                    <div>
                        <button mat-button matStepperPrevious type="button">Back</button>
                        <button mat-button matStepperNext type="button">Next</button>
                    </div>
                </div>
            </div>
        </mat-step>

        <mat-step label="HER2 Receptor">
            <div formGroupName="receptors">
                <div formGroupName="her2Receptor">
                    <mat-radio-group formControlName="status" 
                        aria-label="Human Endothelial Growth Receptor 2">
                        <mat-radio-button value="{{biopsyReceptorStatusEnum.Positive}}" >
                            HER2+
                        </mat-radio-button>
                        <mat-radio-button value="{{biopsyReceptorStatusEnum.Negative}}" >
                            HER2-
                        </mat-radio-button>
                        <mat-radio-button value="{{biopsyReceptorStatusEnum.Unknown}}" >
                            {{biopsyReceptorStatusEnum.Unknown}}
                        </mat-radio-button>
                    </mat-radio-group>

                    <div class="spacer"></div>

                    <mat-radio-group formControlName="test" 
                        aria-label="Human Endothelial Growth Receptor 2">
                        <mat-radio-button value="{{her2TestEnum.IHC}}" >
                            {{her2TestEnum.IHC}}
                        </mat-radio-button>
                        <mat-radio-button value="{{her2TestEnum.FISH}}">
                            {{her2TestEnum.FISH}}
                        </mat-radio-button>
                    </mat-radio-group>
                </div>

                <div>
                    <button mat-button matStepperPrevious type="button">Back</button>
                    <button mat-button matStepperNext type="button">Next</button>
                </div>
            </div>
        </mat-step>

        <mat-step label="Grade">
            <div formGroupName="features">
                <mat-radio-group aria-label="Grade"  formControlName="grade">
                    <mat-radio-button value="{{biopsyGradeEnum.Grade1}}">
                        {{biopsyGradeEnum.Grade1}}
                    </mat-radio-button>
                    <mat-radio-button value="{{biopsyGradeEnum.Grade2}}">
                        {{biopsyGradeEnum.Grade2}}
                    </mat-radio-button>
                    <mat-radio-button value="{{biopsyGradeEnum.Grade3}}">
                        {{biopsyGradeEnum.Grade3}}
                    </mat-radio-button>
                    <mat-radio-button value="{{biopsyGradeEnum.UnableToGrade}}">
                        {{biopsyGradeEnum.UnableToGrade}}
                    </mat-radio-button>
                    <mat-radio-button value="{{biopsyGradeEnum.NoGradeGiven}}" >
                        {{biopsyGradeEnum.NoGradeGiven}}
                    </mat-radio-button>
                </mat-radio-group>

                <div>
                    <button mat-button matStepperPrevious type="button">Back</button>
                    <button mat-button matStepperNext type="button">Next</button>
                </div>
            </div>
        </mat-step>

        <mat-step label="LVI">
            <div formGroupName="features">
                <mat-radio-group aria-label="LVI" formControlName="lvi">
                    <mat-radio-button value="{{biopsyLviStatusEnum.Positive}}" >
                        {{biopsyLviStatusEnum.Positive}}
                    </mat-radio-button>
                    <mat-radio-button value="{{biopsyLviStatusEnum.Negative}}" >
                        {{biopsyLviStatusEnum.Negative}}
                    </mat-radio-button>
                    <mat-radio-button value="{{biopsyLviStatusEnum.NotDetermined}}" >
                        {{biopsyLviStatusEnum.NotDetermined}}
                    </mat-radio-button>
                </mat-radio-group>

                <div>
                    <button mat-button matStepperPrevious type="button">Back</button>
                    <button mat-button matStepperNext type="button">Next</button>
                </div>
            </div>
        </mat-step>

        <mat-step label="Done">
            <div>
                <button mat-raised-button type="submit" color="primary"
                    [disabled]="!biopsyForm.valid">Submit</button>
                <button mat-button type="reset">Reset</button>
                <button mat-button type="button" (click)="onCancel()">Cancel</button>
            </div>
        </mat-step>

    </mat-vertical-stepper>
</form>

<ng-template #dialogRef>
    Is this correct?
    <app-view-biopsy-template [biopsy]="this.biopsyForm.value"
        [isEmbedded]="true">
    </app-view-biopsy-template>
    <mat-dialog-actions align="end">
        <button mat-button mat-dialog-close>Cancel</button>
        <button mat-raised-button [mat-dialog-close]="true" cdkFocusInitial
            (click)="onConfirm()" color="primary">Confirm</button>
    </mat-dialog-actions>
</ng-template>